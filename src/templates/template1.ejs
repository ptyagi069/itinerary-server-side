<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= data.packageInfo.packageName  %></title>
    <link href="https://cdn.jsdelivr.net/npm/remixicon@4.5.0/fonts/remixicon.css" rel="stylesheet" />
</head>

<style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Nunito+Sans:ital,opsz,wght@0,6..12,200..1000;1,6..12,200..1000&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap');
    @import url('https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Nunito+Sans:ital,opsz,wght@0,6..12,200..1000;1,6..12,200..1000&family=Open+Sans:ital,wght@0,300..800;1,300..800&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap');

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Poppins", sans-serif;
    }

    html,
    body {
        margin: 0;
        padding: 0;
        width: 100%;
        overflow-y: scroll;
    }

    .a4-page {
        width: 210mm;
        height: 297mm;
    }

    .header-part {
        width: 100%;
        background: linear-gradient(to left, rgba(0, 0, 0, 0) 0%, rgba(247, 245, 245, 0.486) 100%);
        padding-block: 10px;
        padding-inline: 10px;
        display: flex;
        justify-content: space-between;
    }

    .header-part h1 {
        color: white;
        width: fit-content;
    }

    .package-intro {
        padding: 40px;
        width: 70%;
    }

    .regionname {
        font-family: "Poppins", serif;
        font-size: 18px;
        font-weight: 300;
        line-height: 35px;
        letter-spacing: 0.17em;
        text-align: left;
        text-underline-position: from-font;
        text-decoration-skip-ink: none;
        color: white;
    }

    .duration p {
        font-family: Poppins;
        font-size: 16px;
        font-weight: 700;
        text-align: center;
        color: white;
    }

    .duration {
        margin-top: 10px;
        padding-inline: 20px;
        padding-block: 15px;
        border-radius: 20px;
        width: fit-content;
        display: flex;
        justify-content: center;
        align-items: center;
        height: fit-content;
        background-color: rgba(0, 0, 0, 0.07);
        backdrop-filter: blur(7.4px);
    }

    .package-desc {
        font-family: Poppins;
        font-size: 11px;
        font-weight: 300;
        text-align: left;
        color: white;
        margin-top: 2rem;
    }

    .white-card {
        width: 100%;
    padding-left: 0px;
    padding-right: 0px;
    padding-block: 9px;
    background-color: white;
    color: #5C5B5B;
    margin-top: 2rem;
    display: flex;
    justify-content: center;
    align-items: center;
    }

    .inner-white-card {
        width: 97%;
        padding-left: 10px;
        padding-right: 30px;
        padding-block: 10px;
        background-color: white;
        color: #5C5B5B;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .leftie {
        padding: 10px;
        padding-right: 20px;
        border-right: 1px solid #5C5B5B;
        display: flex;
        justify-content: space-between;
        align-items: flex-end;
        gap: 20px;
    }

    .rightie {
        padding: 10px;
        padding-left: 10px;
    }

    .price-from-text {
        font-family: Inter;
        font-size: 14px;
        font-weight: 400;
        color: black !important;
    }

    .leftie span {
        font-family: Inter;
        font-size: 10px;
        font-weight: 400;
        margin-bottom: 7px;

    }

    .priceu {
        font-family: Inter;
        font-size: 24px;
        font-weight: 800;
        color: #5C5B5B;
        margin-top: 5px;
    }

    .travel-text {
        font-family: Inter;
        font-size: 14px;
        font-weight: 400;
        color: black !important;
    }

    .travel-date {
        font-family: Inter;
        font-size: 20px;
        font-weight: 800;
    }

    .inclusions-icons {
        font-family: Open Sans;
        font-size: 14px;
        font-weight: 700;
        color: #ffffff80;
        margin-top: 2rem;
    }

    .golu {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        background-color: white;
        color: #333;
        border-radius: 50%;
        width: fit-content;
        padding: 10px;
        font-size: 20px;
        font-weight: 100;
    }

    .tat {
        color: rgba(240, 248, 255, 0.747);
        margin-top: 2rem;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        gap: 10px;
    }

    #dest-baro {
        margin-right: 1rem;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        gap: 30px;
        height: fit-content;
        border-right: 1px dotted white;
    }

    .dest {
        color: white;
        transform: rotate(-90deg);
        height: 180px;
        text-wrap: wrap;
        text-wrap: wrap;
        width: 103px;
        position: relative;
    }


    .dest p {
        max-width: 150px;
        word-wrap: break-word;
        white-space: normal;
    }

    .dot {
        position: absolute;
        height: 15px;
        width: 15px;
        background-color: #ffffff;
        border-radius: 50%;
        display: inline-block;
        bottom: 32px;
    }

    .dot1 {
        left: 126px;
        position: absolute;
        height: 15px;
        width: 15px;
        background-color: #ffffff;
        border-radius: 50%;
        display: inline-block;
    }

    .hero-section {
        position: relative;
        height: 264px;
        background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)),
            url('https://img.freepik.com/premium-photo/wild-monkey-monkey-forest-bali-indonesia_236845-631.jpg');
        background-position: center;
        background-size: cover;
        overflow: hidden;
    }


    .hero-section h1 {
        font-family: Poppins;
        font-size: 122px;
        font-weight: 700;
        line-height: 89px;
        text-align: left;
        text-underline-position: from-font;
        text-decoration-skip-ink: none;
        color: rgb(255, 255, 255);
    }

    .badmas {
        position: absolute;
        top: 6.4rem;
        left: 10%;
    }

    .boxi {
        width: 134px;
        height: 61px;
        border-right: 1px dotted white;
    }

    .upper-half {
        width: 100%;
        display: flex;
        justify-content: space-between;
    }

    .lower-half {
        width: 100%;
        display: flex;
        justify-content: space-between;
    }

    .laft {
        display: flex;
        align-items: flex-start;
        flex-direction: column;
        width: 70%;
    }

    .laft div {
        border-right: 1px solid #A5A5A5;
        border-bottom: 1px solid #A5A5A5;

    }

    .firstboy {
        width: 30%;
        padding-block: 20px;
        padding-inline: 10px;
    }



    .secondboy {
        width: 40%;
        padding-block: 20px;
        padding-inline: 10px;

    }

    .thirdboy {
        width: 40%;
        padding-block: 20px;
        padding-inline: 10px;

    }

    .lower-half div {
        border-bottom: 0px;
    }

    .firstboy i {
        color: #6563FF;
        font-size: 16px;

    }

    .whyperfect {
        font-family: Poppins;
        font-size: 22px;
        font-weight: 600;
        line-height: 89px;
        letter-spacing: -0.02em;

    }

    .youenjoy {
        font-family: Poppins;
        font-size: 22px;
        font-weight: 600;
        line-height: 89px;
        letter-spacing: -0.02em;
    }

    .enjoy-card {
        background-color: #DEE5FA;
        color: #7E95DA;
        padding-inline: 25px;
        padding-block: 10px;
        border-radius: 20px;
        width: fit-content;
        font-family: "Open Sans", sans-serif;
        font-size: 10px;
        font-weight: 700;
    }

    #whyperfecttext {
        color: #5E5E5E;
        font-family: Open Sans;
        font-size: 17px;
        font-weight: 400;
        line-height: 20px;
    }

    .secondboy h1 {
        font-family: Poppins;
        font-size: 20px;
        font-weight: 900;
        line-height: 10px;
        margin-bottom: 10px;
    }

    .tete {
        font-family: Poppins;
        font-size: 18px;
        font-weight: 600;
        display: flex;
        justify-content: flex-start;
        align-items: center;
    }

    .tete i {
        font-size: 20px;
        margin-right: 10px;
    }

    .heading-page3 {
        font-family: Poppins;
        font-size: 60px;
        font-weight: 700;
        line-height: 89px;
        text-align: left;
        margin-left: 48px;
        margin-top: 20px;
    }
</style>

<style>
    .day-container {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        grid-template-rows: repeat(3, auto);
        gap: 10px 15px;
    }

    .day-item {
        padding: 20px;
        font-size: 16px;
    }
</style>

<style>
    .bloop7yui_container {
        margin-top: 40px auto;
        padding-inline: 50px;
        padding-block: 10px;
    }

    .florp8k_title-section {
        margin-bottom: 10px;
    }

    .smoof6t_header {
        margin-top: 11px;
        font-size: 28px;
        color: #111;
        margin-bottom: 10px;
        font-weight: 500;
        line-height: 36.6px;
    }

    .zorp5r_subheader {
        color: #7F7F7F;
        ;
        font-size: 14px;
    }

    .noodle_button {
        padding-inline: 25px;
        padding-block: 10px;
        color: white;
        background-color: #005BFF;
        border-radius: 5px;
        margin-bottom: 10px;
    }

    .activity-card {
        width: 31%;
    height: 119px;
    }
</style>

<style>
    .hotel-name {
        color: #676767;
        font-size: 20px;
        font-weight: 500;
    }

    .blop-container {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        padding: 20px;
        position: relative;
    }

    .sqwiggle-line {
        border-left: 3px solid #229ADE;
        position: absolute;
        height: 100%;
        left: 42px;
        top: 0;
    }

    .flooper-item {
        width: 600px;
        display: flex;
        align-items: flex-start;
        margin-bottom: 40px;
        position: relative;
    }

    .boop-number {
        width: 50px;
        height: 50px;
        background-color: #229ADE;
        color: white;
        font-weight: bold;
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        margin-right: 20px;
        flex-shrink: 0;
        z-index: 1;
    }

    .text-blabble {
        flex: 1;
    }

    .text-blabble h3 {
        color: #229ADE;
        margin: 0 0 10px;
    }

    .text-blabble p {
        color: #666;
        margin: 0;
    }

    .qr-blurp {
        margin-top: 10px;
    }

    .qr-blurp img {
        width: 100px;
        height: 100px;
    }
</style>

<body>
    <div class="a4-page" id="first-page">
        <section class="header-part">
           
        </section>
        
        <section style="display: flex; align-items: flex-end; justify-content: space-between; height: 90%;">
            <div class="package-intro" style="    height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: space-between;">
               
              <div>
                <p class="regionname">
                    Explore 
                </p>
                    <p id="packagename">
                       
                    </p>
                    <div class="duration">
                        <p id="dura-tomo">
                            10 Nights - 11 Days
                        </p>
                    </div>
              </div>

               

                <div class="package-desc" id="pkgdsc" style="display: none;">
                   
                </div>

                <div class="white-card">
                    <div class="inner-white-card">

                        <div class="leftie">
                            <div>
                                <p class="price-from-text">Price from</p>
                                <p class="priceu" id="price-top">$ 900</p>
                            </div>
                            <span>
                                Per Person
                            </span>
                        </div>

                        <div class="rightie">
                            <p class="trave-text">Travel on</p>
                            <p class="travel-date" id="tour-date"> 5th May' 2024</p>
                        </div>


                    </div>
                </div>


                <div class="inclusions-icons" style="display: none;">
                    <p>Trip Inclusions :</p>

                    <div style="display: flex; align-items: center; gap: 30px;">
                        <div class="tat">
                            <i class="ri-hotel-line golu"></i>
                            <p>Hotel</p>
                        </div>

                        <div class="tat">
                            <i class="ri-camera-line golu"></i>
                            <p>Sight Seeing</p>
                        </div>

                        <div class="tat">
                            <i class="ri-restaurant-2-line golu"></i>
                            <p>Meals</p>
                        </div>

                        <div class="tat">
                            <i class="ri-car-line golu"></i>
                            <p>Tranfers</p>
                        </div>
                    </div>
                </div>


            </div>


            <div id="dest-baro" class="destinations-bar">

              
            </div>
        </section>

    </div>

    <div class="a4-page" id="second-page">
        <section class="header-part">
        </section>


        <section class="hero-section">

            <div class="overlay" style="position: relative; color: white; left: 80%; top: 10%;">
                <div  class="start-dates boxi"
                    style="display: flex; justify-content: flex-end; align-items: center; padding: 20px;">
                        <p id="start-dates">

                        </p>
                    <span class="dot1"></span>
                </div>

                <div   class="end-dates boxi"
                    style="display: flex; justify-content: flex-end; align-items: center; padding: 20px;">
                    <p id="end-dates">

                    </p>
                    <span class="dot1"></span>
                </div>
            </div>

            <div class="badmas">
                <h1 class="upar">Trip</h1>
                <h1 class="neeche">Overview</h1>
            </div>
        </section>


        <section>

        </section>

        <section style="display: flex; flex-direction: row-reverse; padding: 30px;">
            <div style="width: 30%; padding: 10px;">
                <p class="tete">
                    <i class="ri-restaurant-2-line"></i> Group Size
                </p>

                <p style="margin-top: 10px;">
                    Small to medium group tours for guided excursions
                    Independent travel options available for free exploration days
                </p>
            </div>

            <div class="laft">
                <section class="upper-half">
                    <div class="firstboy">
                        <h1 id="pkgtotaldays-1" style="    font-family: Poppins;
                    font-size: 20px;
                    font-weight: 900;"></h1>

                        <span>DAYS</span>
                    </div>

                    <div class="secondboy">
                        <h1 id="citycount"></h1>
                        <br>
                        <span id="cities">Bali, Kuta, Ubud</span>
                    </div>

                    <div class="thirdboy">
                        <p class="tete">
                            <i class="ri-restaurant-line"></i> Meals
                        </p>
                        <br>
                        <span>Breakfast, Lunch, Dinner</span>
                    </div>


                </section>
                <section class="lower-half">
                    <div class="firstboy">
                        <i class="ri-star-fill"></i>
                        <i class="ri-star-fill"></i>
                        <i class="ri-star-fill"></i>
                        <i class="ri-star-fill"></i>
                        <i class="ri-star-fill"></i>

                        <h3>
                            5 Star Ratings
                        </h3>
                    </div>

                    <div class="secondboy">
                        <h1 id="hotelcount"></h1>

                        <p id="hotelss" style="font-size: 10px;">
                           
                        </p>
                    </div>

                    <div class="thirdboy">
                        <p class="tete">
                            <i class="ri-car-line"></i> Transfer
                        </p>
                        <p>
                            Convinient Shared Transfer in cozy AC coaches or car.
                        </p>
                    </div>
                </section>
            </div>
        </section>


        <section
            style="display: flex; justify-content: space-between; align-items: flex-start; padding: 30px; gap: 60px;">
            <div style="width: 50%;">
                <h1 class="whyperfect">
                    Why is this trip perfect for you
                </h1>

                <div id="whyperfecttext">

                    Experience Spain's rich culture and history
                    Explore top European party destinations (Ibiza)
                    Discover Mediterranean beaches and beautiful landscapes
                    Savor diverse cuisine, vibrant nightlife, and scenic tours
                    Enjoy UNESCO World Heritage sites and famous landmarks
                </div>
            </div>

            <div style="width: 50%;">
                <h1 class="youenjoy">
                    You’ll enjoy this trip if you are
                </h1>


                <section id="enjoy-cards" style="display: flex; flex-wrap: wrap; gap: 10px;">

                
                </section>

            </div>
        </section>
    </div>

    <div class="a4-page">
        <section class="header-part">
            
        </section>

        <h1 class="heading-page3">
            Day Wise Schedule
        </h1>
        <div id="daywiseiti" class="day-container" style="padding: 50px; height: fit-content;">
            <div class="day-item">
                <h3>
                    Day 1 - Bali
                </h3>

                <p
                    style="color:#676767; font-size: 14px; padding-bottom: 5px; border-bottom:  1px solid #D4D4D4; padding-top: 10px;">
                    The Anvaya Beach Resort or Similar
                </p>
                <section style="font-size: 12px; color:#999999; margin-top: 20px;">
                    Set out on a trip of a lifetime to Bali,
                    a place where culture, adventure, and peace all
                    Rejuvenate your mind, body, and soul with
                    Bali Spa experience and indulge in the ultimate in relaxation.
                </section>
            </div>
            <div class="day-item">
                <h3>
                    Day 1 - Bali
                </h3>

                <p
                    style="color:#676767; font-size: 14px; padding-bottom: 5px; border-bottom:  1px solid #D4D4D4; padding-top: 10px;">
                    The Anvaya Beach Resort or Similar
                </p>
                <section style="font-size: 12px; color:#999999; margin-top: 20px;">
                    Set out on a trip of a lifetime to Bali,
                    a place where culture, adventure, and peace all
                    Rejuvenate your mind, body, and soul with
                    Bali Spa experience and indulge in the ultimate in relaxation.
                </section>
            </div>
     
        </div>



    </div>

    <section id="dynamic-itinerary">
        
    </section>

    <section id="dynamic-hotel-list-5stars">

    </section>

    <section id="dynamic-hotel-list-4stars">

    </section>

    <!-- inclusions and exclusions  -->
    <div class="a4-page">
        <section class="header-part">
          
        </section>

        <section id="incexccontainer" style="font-family: Arial, sans-serif; padding: 40px;">  
        </section>
    </div>

    <div class="a4-page">
        <!-- Header -->

        <section class="header-part">

        </section>
       

        <section style="padding: 30px;">
            <h1 style="text-align: left; color: #000000; font-size: 24px; margin-bottom: 10px;">Cancellation Policy</h1>
        
            <!-- Cancellation Policy -->
            <p style="line-height: 1.6; color: #555;">
                Deposits are non-refundable. However, if canceled more than 60 days before the travel date, you can transfer it to another date or trip.
            </p>
            <p style="line-height: 1.6; color: #555;">
                If canceled less than 60 days before the trip, deposits are non-refundable and non-transferable. For the balance amount, the below cancellation fee will be applicable:
            </p>
    
            <!-- Cancellation Charges Table -->
            <h2 style="color: #000000; font-size: 20px; margin-top: 20px;">Cancellation Charges</h2>
            <table style="width: 100%; border-collapse: collapse; margin: 20px 0;">
                <thead>
                    <tr>
                        <th style="background-color: #5bc0de; color: #fff; padding: 10px; text-align: left;">When a cancellation is made</th>
                        <th style="background-color: #5bc0de; color: #fff; padding: 10px; text-align: center;">Cancellation Cost</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td style="border: 1px solid #ddd; padding: 10px;">06 days - Less than 72 hrs or no show</td>
                        <td style="border: 1px solid #ddd; padding: 10px; text-align: center;">100% No Refund</td>
                    </tr>
                    <tr>
                        <td style="border: 1px solid #ddd; padding: 10px;">30 - 07 days prior to arrival</td>
                        <td style="border: 1px solid #ddd; padding: 10px; text-align: center;">75% of the tour</td>
                    </tr>
                    <tr>
                        <td style="border: 1px solid #ddd; padding: 10px;">60 - 31 days prior to arrival</td>
                        <td style="border: 1px solid #ddd; padding: 10px; text-align: center;">40% of the tour</td>
                    </tr>
                </tbody>
            </table>
    
            <!-- Rates Table -->
            <h2 style="color: #000000; font-size: 20px; margin-top: 20px;">Rates</h2>
            <table style="width: 100%; border-collapse: collapse; margin: 20px 0;">
                <thead>
                    <tr>
                        <th style="background-color: #5bc0de; color: #fff; padding: 10px;">Tour Date</th>
                        <th style="background-color: #5bc0de; color: #fff; padding: 10px;">Room Category</th>
                        <th style="background-color: #5bc0de; color: #fff; padding: 10px;">Twin/Triple Occupancy</th>
                        <th style="background-color: #5bc0de; color: #fff; padding: 10px;">Single Occupancy</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td style="border: 1px solid #ddd; padding: 10px;">Mar 27, 2025</td>
                        <td style="border: 1px solid #ddd; padding: 10px;">Standard Room</td>
                        <td style="border: 1px solid #ddd; padding: 10px; text-align: center;">$962</td>
                        <td style="border: 1px solid #ddd; padding: 10px; text-align: center;">$1489</td>
                    </tr>
                </tbody>
            </table>
        </section>
    </div>


    <div class="a4-page" style="overflow: hidden;">
        <section class="header-part">
          
        </section>

        <section
            style=" margin-inline: 10px; height: 460px; background-image: url('/finalpage-top.png'); background-size: cover; background-repeat: no-repeat; background-position: center;">

        </section>

        <div class="blop-container">
            <div class="sqwiggle-line"></div>

            <div class="flooper-item">
                <div class="boop-number">01</div>
                <div class="text-blabble">
                    <h3>Scan this QR Code</h3>
                    <p>
                       Scan this QR Code and let's get started.  
                    </p>
                    <div class="qr-blurp">
                        <img id="qr-code-image"  src="" alt="">
                    </div>
                </div>
            </div>

            <div class="flooper-item">
                <div class="boop-number">02</div>
                <div class="text-blabble">
                    <h3>Make a new booking</h3>
                    <p>The Leela Ambience, Delhi / Radisson blu, Dwarka / Vivanta by</p>
                </div>
            </div>

            <div class="flooper-item">
                <div class="boop-number">03</div>
                <div class="text-blabble">
                    <h3>Enter your Details</h3>
                    <p>The Leela Ambience, Delhi / Radisson blu, Dwarka / Vivanta by</p>
                </div>
            </div>

            <div class="flooper-item">
                <div class="boop-number">04</div>
                <div class="text-blabble">
                    <h3>Pay and confirm your Spot</h3>
                    <p>The Leela Ambience, Delhi / Radisson blu, Dwarka / Vivanta by</p>
                </div>
            </div>
        </div>
    </div>
    <span id="data-fromejscontroller">

    </span>

</body>

<script>

function parseHtmlList(htmlString) {
    return htmlString
        .replace(/<\/?[^>]+(>|$)/g, '')
        .split('*')
        .filter(item => item.trim())
        .map(item => item.trim());
}

const temp = document.getElementById('data-fromejscontroller').innerHTML;
const pkgdate = "<%= data.pkgdate %>" 
const packageinformation = <%- JSON.stringify(data.packageInfo) %>;
const itinerary =  <%- JSON.stringify(data.itinerary) %> ; 
const incexc = <%- JSON.stringify(data.inclusionsExclusions) %> ;
const hotels = <%- JSON.stringify(data.hoteldetails) %>  ;
const packagerates = <%- JSON.stringify(data.packagerates) %>  ;
const agencyProfile = <%- JSON.stringify(data.agencyProfile) %>  ;
const inclusionsExclusions = <%- JSON.stringify(data.inclusionsExclusions) %> ;
const qrcodedata = <%- JSON.stringify( data.qr) %> ;
const fiveStarHotels = hotels.filter(hotel => hotel.starRating === "5");
const fourStarHotels = hotels.filter(hotel => hotel.starRating === "4");
console.log(qrcodedata);
const qrImageElement = document.getElementById('qr-code-image');

qrImageElement.src = qrcodedata.message;

function chunkArray(array, size) {
    const chunked = [];
    for (let i = 0; i < array.length; i += size) {
        chunked.push(array.slice(i, i + size));
    }
    return chunked;
}
const daywiseschedule = packageinformation.cityhighlights;
console.log(daywiseschedule);
const pkgtotaldays = packageinformation.pkg_noofdays;
const dateString = pkgdate;
const date  = new Date(dateString.split('/').reverse().join('-'));
const formattedDate = `${date.getDate()}th ${date.toLocaleDateString('en-US', { month: 'short' })} ${date.getFullYear()}`;
const newDate = new Date(date);
newDate.setDate(newDate.getDate() + pkgtotaldays);
const formattedEndDate = `${newDate.getDate()}th ${newDate.toLocaleDateString('en-US', { month: 'short' })} ${newDate.getFullYear()}`;
const getCityNames = (cityHighlightsStr) => {
    try {
        const cityHighlights = JSON.parse(cityHighlightsStr);
        const cities = cityHighlights
            .map(item => item.City.trim())
            .filter(city => city !== "Departure")
            .filter((city, index, self) => 
                self.indexOf(city) === index
            );
        return cities;
    } catch (error) {
        console.error('Error parsing city highlights:', error);
        return [];
    }
};
const getHotelNames = (hotelListStr) => {
    try {
        const hotelList = JSON.parse(hotelListStr);
        return hotelList.map(hotel => hotel.HTL_NAME);
    } catch (error) {
        console.error('Error parsing hotel list:', error);
        return [];
    }
};
const parseYoullLoveThis = (youllLoveThisStr) => {
    try {
        const loveThisList = JSON.parse(youllLoveThisStr);
        return loveThisList.map(item => item.SuitForTravellersType);
    } catch (error) {
        console.error('Error parsing youlllovethis:', error);
        return [];
    }
};
const bindEnjoyCards = (travelerTypes) => {
    const enjoyCardsSection = document.getElementById('enjoy-cards');
    enjoyCardsSection.innerHTML = '';
    let i = 0;
    travelerTypes.forEach(type => {
        if(i >= 8) {
            return; 
        }
        const card = document.createElement('div');
        card.className = 'enjoy-card';
        card.textContent = type;
        enjoyCardsSection.appendChild(card);
        i++; 
    });
};
const hotelNames = getHotelNames(packageinformation.hotel_list);
const cityList = getCityNames(packageinformation.cityhighlights);
const travelerTypes = parseYoullLoveThis(packageinformation.youlllovethis);

let commonheaderpart = `
            <div style="display: flex; justify-content: center; align-items: center; gap: 20px; color:black;">
                <img class="agent-company-logo" src=" ${agencyProfile.companyLogo}" alt="" width="100px">
                <h1 class="agent-kompanyName" style="color: black;">${agencyProfile.company_Name}</h1>
            </div>
            <div style="display: flex; justify-content: center; flex-direction: column; ">
                <p class="agent-phone-num" style="text-decoration: none; color: black;">
                ${agencyProfile.contact}</p>
                <a class="agent-email" style="text-decoration: none; color: black;" href="mailto:${agencyProfile.emailId}">
                    ${agencyProfile.emailId}</a>
            </div>`;
const headerparts = document.querySelectorAll('.header-part');

headerparts.forEach((part, index) => {
    const profile = agencyProfile;
    if (profile) {
        if(index === 0){
            part.innerHTML = `
            <div style="display: flex; justify-content: center; align-items: center; gap: 20px;">
                <img class="agent-company-logo" src=" ${profile.companyLogo}" alt="" width="100px">
                <h1 class="agent-kompanyName">${profile.company_Name}</h1>
            </div>
            <div style="display: flex; justify-content: center; flex-direction: column;">
                <p class="agent-phone-num" style="text-decoration: none; color: white;">
                ${profile.contact}</p>
                <a class="agent-email" style="text-decoration: none; color: white;" href="mailto:${profile.emailId}">
                    ${profile.emailId}</a>
            </div>`;
        }
        else{
            part.innerHTML = `${commonheaderpart}`;
        }
       
    }
});
initDestinationsBar(itinerary, 'dest-baro');
document.getElementById('packagename').innerHTML = packageinformation.packageName;
document.getElementById('packagename').style = `      
        font-family: "Poppins", serif;
        font-size: 51px;
        line-height: 61px;
        font-weight: 700;
        color: white;
        text-wrap: pretty;
        margin-top: 10px;`;
document.getElementById('dura-tomo').innerHTML = `${packageinformation.pkg_noofdays -1} Nights  - ${packageinformation.pkg_noofdays} Days`;
document.getElementById('first-page').style.backgroundImage = `url('https://cms.tripoculture.com/${packageinformation.PKG_IMAGE}')`;
document.getElementById('first-page').style = `width: 210mm;
          background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)),
            url('https://cms.tripoculture.com/${packageinformation.PKG_IMAGE}');
          background-position: center;
          background-size: cover;
          background-repeat : no-repeat;
       `;
document.getElementById('pkgdsc').textContent = packageinformation.description;
document.getElementById('tour-date').textContent = formattedDate;
document.getElementById('start-dates').textContent = formattedDate;
document.getElementById('end-dates').textContent = formattedEndDate;
document.getElementById('price-top').innerText = `$` +`${parseInt( packagerates['singdclienT_PRICE'])}`;
document.getElementById('pkgtotaldays-1').textContent = pkgtotaldays;
document.getElementById('citycount').textContent = ` No.of Cities : ${cityList.length}`;
document.getElementById('hotelcount').textContent = ` Your Stays : ${hotelNames.length}`;
bindEnjoyCards(travelerTypes);
function createDestinationsBar(itinerary) {
    const destBar = document.createElement('div');
    destBar.id = 'dest-bar';
    destBar.className = 'destinations-bar';
    const maxDisplay = 4;
    itinerary.slice(0, maxDisplay).forEach(item => {
        const destDiv = document.createElement('div');
        destDiv.className = 'dest';

        const dayText = document.createElement('p');
        dayText.className = 'day-text';
        dayText.textContent = `DAY - ${item.day}`;

        const destText = document.createElement('p');
        destText.textContent = item.title.split('(')[0].trim();
        const dot = document.createElement('span');
        dot.className = 'dot';
        destDiv.appendChild(dayText);
        destDiv.appendChild(destText);
        destDiv.appendChild(dot);
        destBar.appendChild(destDiv);
    });

    if (itinerary.length > maxDisplay) {
        const moreText = document.createElement('p');
        moreText.style.color = 'white';
        moreText.textContent = 'AND MORE....';
        destBar.appendChild(moreText);
    }

    return destBar;
}

function initDestinationsBar(itinerary, containerId) {
    const container = document.getElementById(containerId);
    if (container) {
        const destBar = createDestinationsBar(itinerary);
        container.innerHTML = ''; 
        container.appendChild(destBar);
    }
}

const citiesSpan = document.getElementById('cities');
citiesSpan.textContent = cityList.join(', ');
document.getElementById('hotelss').textContent = hotelNames.join(', ');



function renderDaySchedule(scheduleData) {
    // Create the container
    const container = document.createElement('div');
    container.className = 'day-container';
    container.style.cssText = 'padding: 50px; height: fit-content;';

    // Function to parse duration and get day numbers
    function parseDuration(duration) {
        const dayMatch = duration.match(/Day (\d+)(?:-Day (\d+))?/);
        if (!dayMatch) return [];
        
        if (dayMatch[2]) {
            // Range of days
            const start = parseInt(dayMatch[1]);
            const end = parseInt(dayMatch[2]);
            return Array.from({length: end - start + 1}, (_, i) => start + i);
        } else {
            // Single day
            return [parseInt(dayMatch[1])];
        }
    }

    // Process each schedule item
    scheduleData.forEach(item => {
        const days = parseDuration(item.Duration);
        
        days.forEach(dayNum => {
            const dayItem = document.createElement('div');
            dayItem.className = 'day-item';
            
            dayItem.innerHTML = `
                <h3>
                    Day ${dayNum} - ${item.City}
                </h3>
                <p style="color:#676767; font-size: 14px; padding-bottom: 5px; border-bottom: 1px solid #D4D4D4; padding-top: 10px;">
                    ${item.City} Highlights
                </p>
                <section style="font-size: 12px; color:#999999; margin-top: 20px;">
                    ${item.Description}
                </section>
            `;
            
            container.appendChild(dayItem);
        });
    });

    return container;
}

const scheduleContainer = renderDaySchedule(daywiseschedule);
document.getElementById('daywiseiti').appendChild(scheduleContainer);


function renderInclusionsExclusions(data) {
    // Find inclusions and exclusions from the data
    const inclusions = data.find(item => item.type === 'inclusion');
    const exclusions = data.find(item => item.type === 'exclusion');

    // Parse the lists
    const inclusionsList = inclusions ? parseHtmlList(inclusions.details) : [];
    const exclusionsList = exclusions ? parseHtmlList(exclusions.details) : [];

    // Get the container
    const container = document.getElementById('incexccontainer');

    // Create HTML for inclusions
    const inclusionsHtml = `
        <div class="trip-positive" style="margin-bottom: 40px;">
            <h2 style="color: #28A745; font-weight: bold; font-size: 24px; margin-bottom: 20px;">Trip Enhancements</h2>
            <ul style="list-style: none; padding: 0;">
                ${inclusionsList.map(item => `
                    <li style="color: #28A745; margin-bottom: 10px;">
                        ✔️ <span style="margin-left: 10px;">${item}</span>
                    </li>
                `).join('')}
            </ul>
        </div>
    `;

    // Create HTML for separator
    const separatorHtml = `
        <div style="border-top: 1px solid #ddd; margin: 40px 0;"></div>
    `;

    // Create HTML for exclusions
    const exclusionsHtml = `
        <div class="trip-negative">
            <h2 style="color: #DC3545; font-weight: bold; font-size: 24px; margin-bottom: 20px;">Trip Deductions</h2>
            <ul style="list-style: none; padding: 0;">
                ${exclusionsList.map(item => `
                    <li style="color: #DC3545; margin-bottom: 10px;">
                        ❌ <span style="margin-left: 10px;">${item}</span>
                    </li>
                `).join('')}
            </ul>
        </div>
    `;

    // Combine all sections and set the container content
    container.innerHTML = `
        <section style="font-family: Arial, sans-serif; padding: 40px;">
            ${inclusionsHtml}
            ${separatorHtml}
            ${exclusionsHtml}
        </section>
    `;
}
renderInclusionsExclusions(incexc);

function safeJSONParse(str) {
    if (!str) return null;
    try {
        return JSON.parse(str);
    } catch (e) {
        console.error('JSON parsing error:', e);
        return null;
    }
}


function cleanHTML(html) {
    if (!html) return '';
    
    // Create a temporary container
    const temp = document.createElement('div');
    temp.innerHTML = html;
    
    // Function to clean a node recursively
    function cleanNode(node) {
        if (node.nodeType === 1) { // Element node
            node.removeAttribute('style');
            node.removeAttribute('class');
            
            // Clean all child nodes
            Array.from(node.childNodes).forEach(cleanNode);
            
            // If it's an empty span with only text content, replace it with its content
            if (node.tagName === 'SPAN' && !node.attributes.length) {
                const parent = node.parentNode;
                while (node.firstChild) {
                    parent.insertBefore(node.firstChild, node);
                }
                parent.removeChild(node);
            }
        }
    }
    
    // Clean the entire content
    cleanNode(temp);
    
    return temp.innerHTML;
}

function createItineraryPage(dayData) {
    const details = safeJSONParse(dayData.details);
    const detailsData = details ? details[0] : {};
    
    // Clean the description HTML
    const cleanedDescription = cleanHTML(dayData.description);
    
    const page = document.createElement('div');
    page.className = 'itinerary-page a4-page';
    page.style.cssText = 'width: 210mm; height:297mm; page-break-after: always;';

    page.innerHTML = `
        <section class="header-part">
            ${commonheaderpart}
        </section>
        
        <section class="header">
            <div class="hero-image" style="height: 280px; background-color: #f5f5f5; position: relative; overflow: hidden;">
                <img src="https://cdn.prod.website-files.com/6768f29a6d5da42209173f20/6768f29b6d5da422091774b3_Rectangle%20(22).svg" alt="Day backdrop" style="width: 100%; height: 100%; object-fit: cover">
                <div style="position: absolute; bottom: -35px; left: 30px; color: white;">
                    <h1 style="font-size: 77px; margin: 0;">Day ${dayData.day.padStart(2, '0')}</h1>   
                </div>
            </div>
        </section>

        <section class="details" style="background-color: #F9F8F6; padding-inline: 30px; padding-block:20px; display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
            <div>
                <strong>Walking Level:</strong> ${detailsData.WalkingPlace || 'N/A'}
            </div>
            <div>
                <strong>Highlights:</strong> ${detailsData.Highlights || 'N/A'}
            </div>
            <div>
                <strong>Transfers:</strong> ${detailsData.Transfers || 'N/A'}
            </div>
        </section>

        <section class="description" style="padding-inline: 30px; padding-block:10px; font-size: 12px !important; color: black !important; background-color: #11111100;">
            ${cleanedDescription}
        </section>
    `;

    return page;
}

function createAddonPage(dayData) {
    const addons = safeJSONParse(dayData.addons);
    if (!addons || addons.length === 0) return null;

    const page = document.createElement('div');
    page.className = 'addon-page a4-page';

    let addonCardsHTML = '';
    addons.forEach(addon => {
        addonCardsHTML += `
         
            <div class="activity-card">
                <section class="activity-card-photo"
                    style="position: relative; height: 80px; background-image: url('${addon.ImagePath}'); border-radius: 10px; overflow:hidden; background-size: cover; background-position: center; background-repeat: no-repeat;">
                    <span
                        style="    position: absolute;
    background-color: #005BFF;
    color: white;
    padding-inline: 10px;
    padding-block: 6px;
    bottom: 0;
    left: 0;
    font-size: 10px;
">
                        $ ${addon.GuestAmount || 'N/A'}
                    </span>
                </section>

                <h3
                    style="font-size:10px;  padding-bottom: 5px; padding-top: 5px; font-weight: 450;">
                    ${addon.SERVICE_NAME || 'N/A'}
                </h3>

               
            </div>
        `;
    });

    page.innerHTML = `
           <section class="header-part">
           ${commonheaderpart}
            </section>
        
        <div class="bloop7yui_container">
            <div class="florp8k_title-section">
                <span class="noodle_button">DAY ${dayData.day}: Additional Activities</span>
                <h1 class="smoof6t_header" style="padding-top: 24px;">Don't leave with regrets—dive into these top adventures!</h1>
                <p class="zorp5r_subheader">These experiences have limited availability on select dates—we secure your spot on your confirmation so you don't miss a moment of this magic!</p>
            </div>
        </div>

        <section style="display: flex; gap:20px; flex-wrap: wrap; align-items: flex-start; padding-inline: 40px;">
            ${addonCardsHTML}
        </section>
    `;

    return page;
}

function displayItinerary(itineraryData) {
    const container = document.getElementById('dynamic-itinerary');

    itineraryData.forEach(dayData => {
        const itineraryPage = createItineraryPage(dayData);
        container.appendChild(itineraryPage);
        const addonPage = createAddonPage(dayData);
        if (addonPage) {
            container.appendChild(addonPage); 
        }
    });
}


displayItinerary(itinerary);


function generateHotelsSection(hotels, isRedTheme = false) {
    const themeColor = isRedTheme ? '#BA6672' : '#005BFF';
    const hotelimage = isRedTheme ? '/red-hotel-p.png' : '/OBJECTS.png';
    const theme2color = isRedTheme ? 'rgb(240 202 208 / 47%)' : '';
    const hotelListHTML = hotels.map(hotel => `
        <section class="hotels-container" style="padding-inline: 20px; padding-top: 5px; margin-bottom: 20px;">
            <div class="hotel-outer-div" style="border-radius: 5px; border: 1px solid #E9E9E9; display: flex; justify-content:space-between; width: 100%;">
                <div class="lefts" style="width: 30%; padding: 10px;">
                    <img
                        width="90%"
                        height="200px"
                        style="object-fit: cover; object-position: center; border-radius: 10px;"
                        src="https://cms.tripoculture.com/${hotel.imagePath.replace('../', '')}"
                        alt="${hotel.name}">
                </div>
                <div class="rights" style="width: 70%; padding-top: 10px; padding-right: 10px; padding-bottom: 10px;">
                    <section style="display: flex; justify-content: space-between;">
                        <div style="display: flex; justify-content: center; align-items:flex-start; flex-direction: column; font-size: 16px; border-bottom: 1px solid #E9E9E9; margin-bottom: 10px;">
                            <p class="hotel-name">
                                ${hotel.name}
                            </p>
                            <div style="display: flex; justify-content: center; align-items: center; gap: 10px;">
                               
                                <p class="hotel-stars" style="font-size: 12px;">
                                    Star Rating: 
                                    ${"⭐".repeat(parseInt(hotel.starRating))}
                                </p>
                            </div>
                        </div>
                        <div style="width: fit-content; display: flex; justify-content: flex-end; align-items: flex-end; gap: 10px; flex-direction: column;">
                            <p class="current-hotel-duration" style="background-color: #3BE67F26; width: fit-content; padding-inline: 15px; padding-block: 7px; font-size: 17px; color: green; border-radius: 20px; border: 1px dotted green;">
                                ${hotel.cityName}
                            </p>
                            <p class="hotel-number-of-nights" style="color: green; font-weight: 600; font-size: 15px;">
                                ${hotel.nights} Nights
                            </p>
                        </div>
                    </section>
                    <section class="hotel-room-details" style="font-size: 13px !important; color: #8F8F8F;">
                        ${hotel.hotelhighlights || 'Complimentary Breakfast'}
                    </section>
                </div>
            </div>
        </section>
    `).join('');

    return `
    <div class="a4-page">
        <section class="header-part">
        ${commonheaderpart}
        </section>

        <section style="background-color: ${theme2color}; display: flex; justify-content: space-between; align-items: flex-end;">
            <div style="padding: 50px;">
                <h1 style="color: ${themeColor}; font-size: 20px; font-family: Open Sans; font-weight: 700; line-height: 20.48px;">
                    Stay Option ${hotels[0].starRating} Star
                </h1>   
                <p class="hotels-briefing" style="color: #7F7F7F; font-size: 16px; font-family: Open Sans; font-weight: 400; line-height: 15.36px; margin-top: 20px;">
                    ${hotels.map(h => h.name).join(' + ')}
                </p>
            </div>
            <img style="margin-right: 40px;" width="150px" height="150px" src="${hotelimage}" alt="">
        </section>

        <section class="hotels-costing" style="padding-block: 20px; background: ${themeColor}; color: white; display: flex; justify-content: space-around; align-items: center; font-family: Arial, sans-serif;">
            <div style="text-align: center;">
                <span style="font-size: 18px; font-weight: bold;">Book now @</span><br>
            </div>
            <div style="text-align: left; border-right: 1px solid white; padding-right: 50px;">
                <span style="font-size: 18px; font-weight: bold;">Single</span><br>
                <span style="font-size: 24px; font-weight: bold;">${parseInt(packagerates.singdclienT_PRICE)}</span> <span style="font-size: 14px;">/per person</span>
            </div>
            <div style="text-align: left;">
                <span style="font-size: 18px; font-weight: bold;">Double</span><br>
                <span style="font-size: 24px; font-weight: bold;">${parseInt(packagerates.dbldclienT_PRICE)}</span> <span style="font-size: 14px;">/per person</span>
            </div>
            <div style="text-align: center;">
                <span style="font-size: 18px; font-weight: bold;">Room Type:</span><br>
                <span style="font-size: 14px;">Standard Room</span>
            </div>
        </section>

        ${hotelListHTML}
    </div>`;
}

// Generate HTML for 5-star hotels
const fiveStarPages = chunkArray(fiveStarHotels, 3);
document.getElementById('dynamic-hotel-list-5stars').innerHTML = 
    fiveStarPages.map(pageHotels => generateHotelsSection(pageHotels, false)).join('');

// Generate HTML for 4-star hotels
const fourStarPages = chunkArray(fourStarHotels, 3);
document.getElementById('dynamic-hotel-list-4stars').innerHTML = 
    fourStarPages.map(pageHotels => generateHotelsSection(pageHotels, true)).join('');
</script>

</html>